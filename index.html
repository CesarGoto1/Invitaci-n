<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéâ KUCHAU Invitaci√≥n - Fin de Semestre 2025</title>
    <link rel="stylesheet" href="estilos.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéâ</text></svg>">
    <script>
    function onPlayerReady(event) {
            console.log('YouTube player listo');
            musicInitialized = true;
            
            // Intentar reproducir inmediatamente m√∫ltiples veces
            const tryPlayMultiple = () => {
                try {
                    event.target.playVideo();
                    console.log('Intentando reproducir YouTube autom√°ticamente');
                    
                    // Despu√©s de 1 segundo, quitar el silencio y poner volumen
                    setTimeout(() => {
                        if (youtubePlayer && youtubePlayer.getPlayerState() === YT.PlayerState.PLAYING) {
                            youtubePlayer.unMute();
                            youtubePlayer.setVolume(50);
                            console.log('Audio activado autom√°ticamente');
                        }
                    }, 1000);
                    
                } catch (error) {
                    console.log('Error al intentar reproducir YouTube:', error);
                }
            };
            
            // Primer intento inmediato
            tryPlayMultiple();
            
            // Segundo intento despu√©s de 500ms
            setTimeout(tryPlayMultiple, 500);
            
            // Tercer intento despu√©s de 1 segundo
            setTimeout(tryPlayMultiple, 1000);
            
            // Si despu√©s de 3 segundos no funciona, usar fallback
            setTimeout(() => {
                if (!isPlayingMusic) {
                    console.log('YouTube no se pudo reproducir autom√°ticamente, intentando fallback');
                    tryFallbackAudio();
                }
            }, 3000);
        }
        </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>


    <!-- Contenedor principal -->
    <div class="app-container">
            <!-- Header KUCHAU -->
        <header class="header">
            <div class="kuchau-logo" id="kuchauLogo">
                <div class="energy-ring"></div>
                <span class="logo-k">K</span>
                <span class="logo-text">UCHAU</span>
            </div>
            <div class="live-time" id="liveTime">
                Cargando...
            </div>
        </header>
        <!-- Invitaci√≥n Principal -->
        <main class="invitation-main">
            <div class="invitation-card">
                <div class="card-header">
                    <h1 class="title-glitch" data-text="FIN DE SEMESTRE 2025">FIN DE SEMESTRE 2025</h1>
                    <div class="subtitle">¬°Celebremos juntos este logro acad√©mico!</div>
                </div>

                <!-- Contador din√°mico -->
                <div class="countdown-section">
                    <div class="countdown-title">‚è∞ Cuenta regresiva para el full KUCHAU</div>
                    <div class="countdown-display" id="countdown">
                        <div class="time-unit">
                            <span class="time-number" id="days">00</span>
                            <span class="time-label">D√≠as</span>
                        </div>
                        <div class="time-unit">
                            <span class="time-number" id="hours">00</span>
                            <span class="time-label">Horas</span>
                        </div>
                        <div class="time-unit">
                            <span class="time-number" id="minutes">00</span>
                            <span class="time-label">Minutos</span>
                        </div>
                        <div class="time-unit">
                            <span class="time-number" id="seconds">00</span>
                            <span class="time-label">Segundos</span>
                        </div>
                    </div>
                </div>

                <!-- Detalles del evento -->
                <div class="event-details">
                    <div class="detail-card" data-detail="date">
                        <i class="fas fa-calendar-alt"></i>
                        <div class="detail-content">
                            <div class="detail-label">Fecha</div>
                            <div class="detail-value" id="eventDate">Viernes 15 de Agosto 2025</div>
                        </div>
                    </div>

                    <div class="detail-card" data-detail="time">
                        <i class="fas fa-clock"></i>
                        <div class="detail-content">
                            <div class="detail-label">Hora</div>
                            <div class="detail-value" id="eventTime">1:00 PM - 7:00 PM</div>
                        </div>
                    </div>

                    <div class="detail-card" data-detail="location">
                        <i class="fas fa-map-marker-alt"></i>
                        <div class="detail-content">
                            <div class="detail-label">Ubicaci√≥n</div>
                            <div class="detail-value" id="eventLocation">Singapur Club - Tri√°ngulo</div>
                        </div>
                    </div>

                    <div class="detail-card" data-detail="weather">
                        <i class="fas fa-cloud-sun"></i>
                        <div class="detail-content">
                            <div class="detail-label">Clima KUCHAU</div>
                            <div class="detail-value" id="weatherInfo">Cargando clima...</div>
                        </div>
                    </div>
                </div>

                <!-- Actividades interactivas -->
                <div class="activities-section">
                    <h3>üéÆ Actividades Planeadas</h3>
                    <div class="activities-grid">
                        <div class="activity-card" data-activity="music">
                            <i class="fas fa-music"></i>
                            <div class="activity-title">DJ KACHAU Mode</div>
                            <div class="activity-desc">Los hits m√°s insanos para activar el modo turbo fiestero.</div>
                        </div>
                        <div class="activity-card" data-activity="games">
                            <i class="fas fa-gamepad"></i>
                            <div class="activity-title">Gr√≠talo KACHAU</div>
                            <div class="activity-desc">Concurso para ver qui√©n saca el KACHAU m√°s potente y desquiciado de la noche.</div>
                        </div>
                        <div class="activity-card" data-activity="photos">
                            <i class="fas fa-camera"></i>
                            <div class="activity-title">KACHAU PhotoBooth</div>
                            <div class="activity-desc">Fotos rid√≠culas, memes garantizados y recuerdos de locura en tiempo real.</div>
                        </div>
                        <div class="activity-card" data-activity="egg">
                            <i class="fas fa-egg"></i>
                            <div class="activity-title">Misi√≥n: Huevito Indestructible</div>
                            <div class="activity-desc">¬øPodr√°s bailar, saltar y sobrevivir a la fiesta sin romper tu huevo?</div>
                        </div>
                        <div class="activity-card" data-activity="dance">
                            <i class="fas fa-dance"></i>
                            <div class="activity-title">El Baile del Huevo Indestructible</div>
                            <div class="activity-desc">Si se te cae, te toca hacer un baile extra rid√≠culo.</div>
                        </div>
                    </div>
                </div>

                <!-- RSVP Interactivo -->
                <div class="rsvp-section">
                    <h3>üìù Confirma tu Asistencia</h3>
                    <div class="rsvp-form">
                        <div class="form-group">
                            <input type="text" id="attendeeName" placeholder="Tu nombre completo" required>
                        </div>
                        <div class="form-group">
                            <select id="attendeeCount">
                                <option value="1">Solo yo</option>
                                <option value="2">2 personas</option>
                                <option value="3">3 personas</option>
                                <option value="4">4+ personas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <textarea id="specialRequests" placeholder="Solicitudes especiales (opcional)"></textarea>
                        </div>
                        <button class="rsvp-button" id="confirmRSVP">
                            <i class="fas fa-check"></i>
                            Confirmar Asistencia
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Control de m√∫sica flotante -->
        <div class="music-control" id="musicControl">
            <i class="fas fa-music"></i>
            <span id="musicStatus">üéµ</span>
        </div>
        <div class="floating-kuchau" id="kuchauFloating">
            <div class="kuchau-energy">‚ö°</div>
            <div class="energy-counter" id="energyCounter">0</div>
        </div>
        <!-- Efectos visuales -->
        <div class="background-effects">
            <div class="floating-particles"></div>
            <div class="energy-waves"></div>
        </div>

        <!-- Notificaci√≥n Toast -->
        <div class="toast-notification" id="toastNotification"></div>
        
        <!-- Reproductor de YouTube (oculto) -->
        <div id="youtube-player" style="display: none;"></div>
        
        <!-- Audio HTML5 de fallback -->
        <audio id="backgroundMusic" style="display: none;" loop>
            <source src="El Alfa El Jefe - Singapur (El Androide).mp3" type="audio/mpeg">
            <!-- Fallback: El Alfa - Singapur (El Androide) desde el archivo local -->
        </audio>
        
        <!-- Sonido de click -->
        <audio id="clickSound" style="display: none;">
            <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmkLBQ==" type="audio/wav">
        </audio>
        
</div>
    </div>

    <!-- JavaScript principal -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- API de YouTube para reproducir m√∫sica -->
    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        // Variables globales
        let energyLevel = 0;
        let clickCount = 0;
        let isPlayingMusic = false;
        let youtubePlayer = null;
        let musicInitialized = false;
        let userInteracted = false;
        let attendees = [
            { name: "Ana Garc√≠a", count: 2 },
            { name: "Carlos L√≥pez", count: 1 }
        ];

        // Inicializaci√≥n de la aplicaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            startLiveUpdates();
            createBackgroundEffects();
            initializeMusicControl();
            setupAutoMusic();
            
            // Inicializar reloj
            updateLiveTime();
            setInterval(updateLiveTime, 1000);
            
            // Mostrar mensaje inicial
            setTimeout(() => {
                if (!isPlayingMusic) {
                    showToast('üéµ Haz clic en cualquier lugar para activar la m√∫sica KUCHAU', 'info');
                }
            }, 2000);
        });

        // Configurar m√∫sica autom√°tica
        function setupAutoMusic() {
            // Intentar reproducir inmediatamente
            setTimeout(() => {
                tryStartMusic();
            }, 100);
            
            // Detectar primera interacci√≥n del usuario para activar m√∫sica
            const firstInteractionEvents = ['click', 'touchstart', 'keydown', 'scroll', 'mousemove'];
            
            function handleFirstInteraction() {
                if (!userInteracted) {
                    userInteracted = true;
                    tryStartMusic();
                    console.log('Primera interacci√≥n detectada, activando m√∫sica');
                    // Remover listeners despu√©s de la primera interacci√≥n
                    firstInteractionEvents.forEach(event => {
                        document.removeEventListener(event, handleFirstInteraction);
                    });
                }
            }
            
            // Agregar listeners para detectar primera interacci√≥n
            firstInteractionEvents.forEach(event => {
                document.addEventListener(event, handleFirstInteraction, { passive: true });
            });
            
            // Intentar m√∫ltiples veces con intervalos m√°s frecuentes
            let attempts = 0;
            const maxAttempts = 10;
            const retryInterval = setInterval(() => {
                if (!isPlayingMusic && attempts < maxAttempts) {
                    attempts++;
                    tryStartMusic();
                    console.log(`Intento ${attempts} de reproducir m√∫sica autom√°ticamente`);
                } else {
                    clearInterval(retryInterval);
                    if (!isPlayingMusic) {
                        console.log('Esperando interacci√≥n del usuario para reproducir m√∫sica');
                    }
                }
            }, 1000);
        }

        // Intentar iniciar m√∫sica autom√°ticamente
        function tryStartMusic() {
            console.log('Intentando iniciar m√∫sica...');
            
            if (youtubePlayer && musicInitialized) {
                console.log('Usando YouTube player');
                youtubePlayer.playVideo();
            } else {
                console.log('Usando audio HTML5');
                // Usar audio HTML5
                const backgroundMusic = document.getElementById('backgroundMusic');
                
                // Intentar reproducir con promesa
                const playPromise = backgroundMusic.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        isPlayingMusic = true;
                        updateMusicStatus();
                        showToast('üéµ ¬°M√∫sica KUCHAU activada!', 'success');
                        console.log('M√∫sica HTML5 iniciada correctamente');
                    }).catch(error => {
                        console.log('No se pudo reproducir autom√°ticamente:', error);
                        showToast('üéµ Haz clic para activar la m√∫sica', 'info');
                    });
                }
            }
        }

        // Funci√≥n que se ejecuta cuando la API de YouTube est√° lista
        function onYouTubeIframeAPIReady() {
            youtubePlayer = new YT.Player('youtube-player', {
                height: '0',
                width: '0',
                videoId: 'RCufThTuB3M', // El Alfa "El Jefe" - Singapur (El Androide)
                playerVars: {
                    autoplay: 1,
                    loop: 1,
                    playlist: 'RCufThTuB3M', // Para loop infinito
                    controls: 0,
                    disablekb: 1,
                    fs: 0,
                    iv_load_policy: 3,
                    modestbranding: 1,
                    playsinline: 1,
                    rel: 0,
                    showinfo: 0,
                    start: 0,
                    mute: 1, // Empezar silenciado para evitar bloqueos
                    enablejsapi: 1
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError
                }
            });
        }

        // Cuando el reproductor de YouTube est√° listo
        function onPlayerReady(event) {
            console.log('YouTube player listo');
            youtubePlayer.setVolume(30); // Volumen al 30%
            musicInitialized = true;
            
            // Intentar reproducir inmediatamente
            setTimeout(() => {
                try {
                    event.target.playVideo();
                    console.log('Intentando reproducir YouTube autom√°ticamente');
                } catch (error) {
                    console.log('Error al intentar reproducir YouTube:', error);
                    tryFallbackAudio();
                }
            }, 1000);
        }

        // Cambios de estado del reproductor
        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                // Si est√° reproduci√©ndose pero silenciado, quitarle el silencio
                if (youtubePlayer.isMuted()) {
                    youtubePlayer.unMute();
                    youtubePlayer.setVolume(50);
                    console.log('Reproduciendo y audio activado');
                }
                isPlayingMusic = true;
                updateMusicStatus();
                showToast('üéµ ¬°Singapur KUCHAU activada!', 'success');
            } else if (event.data == YT.PlayerState.PAUSED) {
                isPlayingMusic = false;
                updateMusicStatus();
            } else if (event.data == YT.PlayerState.BUFFERING) {
                console.log('YouTube buffering...');
            }
        }

        // Errores del reproductor de YouTube
        function onPlayerError(event) {
            console.log('Error en YouTube player:', event.data);
            showToast('üîÑ Usando reproductor alternativo...', 'info');
            // Fallback al audio HTML5
            tryFallbackAudio();
        }

        // Fallback a audio HTML5
        function tryFallbackAudio() {
            const backgroundMusic = document.getElementById('backgroundMusic');
            backgroundMusic.play().then(() => {
                isPlayingMusic = true;
                updateMusicStatus();
                showToast('üéµ M√∫sica alternativa activada', 'success');
            }).catch(() => {
                showToast('‚ùå No se pudo reproducir m√∫sica autom√°ticamente', 'error');
            });
        }

        // Actualizar estado visual de la m√∫sica
        function updateMusicStatus() {
            const musicStatus = document.getElementById('musicStatus');
            musicStatus.textContent = isPlayingMusic ? 'üéµ' : 'üîá';
        }

        // Funci√≥n principal de inicializaci√≥n
        function initializeApp() {
            setupCountdown();
            loadWeatherData();
            initializeKuchauEffects();
        }

        // Configurar event listeners
        function setupEventListeners() {
            // Logo KUCHAU - verificar si existe
            const kuchauLogo = document.getElementById('kuchauLogo');
            if (kuchauLogo) {
                kuchauLogo.addEventListener('click', activateKuchau);
            }
            
            // Bot√≥n KUCHAU flotante - verificar si existe
            const kuchauFloating = document.getElementById('kuchauFloating');
            if (kuchauFloating) {
                kuchauFloating.addEventListener('click', activateFloatingKuchau);
            }
            
            // Tarjetas de actividades
            document.querySelectorAll('.activity-card').forEach(card => {
                card.addEventListener('click', function() {
                    activateActivity(this.dataset.activity);
                });
            });
            
            // Formulario RSVP
            const rsvpButton = document.getElementById('confirmRSVP');
            if (rsvpButton) {
                rsvpButton.addEventListener('click', submitRSVP);
            }
            
            // Detalles del evento editables
            document.querySelectorAll('.detail-card').forEach(card => {
                card.addEventListener('dblclick', function() {
                    makeEditable(this);
                });
            });

            // Control de m√∫sica
            const musicControl = document.getElementById('musicControl');
            if (musicControl) {
                musicControl.addEventListener('click', toggleMusic);
            }
        }

        // Contador regresivo
        function setupCountdown() {
            const eventDate = new Date('2025-08-15T13:00:00');
            
            function updateCountdown() {
                const now = new Date();
                const diff = eventDate - now;
                
                if (diff > 0) {
                    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                    
                    document.getElementById('days').textContent = days.toString().padStart(2, '0');
                    document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                    document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                    document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
                } else {
                    document.getElementById('countdown').innerHTML = '<div class="event-live">¬°EL EVENTO YA COMENZ√ì! üéâ</div>';
                }
            }
            
            setInterval(updateCountdown, 1000);
            updateCountdown();
        }

        // Cargar datos del clima en tiempo real
        async function loadWeatherData() {
    try {
        // Usar solo la API alternativa que no requiere key
        console.log('Usando API de clima sin key requerida');
        await tryAlternativeWeatherAPI();
        
        // Actualizar el clima cada 10 minutos
        setInterval(async () => {
            console.log('Actualizando clima...');
            await tryAlternativeWeatherAPI();
        }, 600000);
        
    } catch (error) {
        console.error('Error cargando clima:', error);
        showFallbackWeather();
    }
}

        // Obtener clima por coordenadas
        async function fetchWeatherByCoords(lat, lon, apiKey) {
            try {
                console.log(`Obteniendo clima para coordenadas: ${lat}, ${lon}`);
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric&lang=es`);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('Datos del clima recibidos:', data);
                    updateWeatherDisplay(data);
                } else {
                    console.log('Error en respuesta de API:', response.status);
                    throw new Error(`Error en la API: ${response.status}`);
                }
            } catch (error) {
                console.error('Error obteniendo clima por coordenadas:', error);
                // Intentar con una API alternativa o usar fallback
                await tryAlternativeWeatherAPI(lat, lon);
            }
        }

        // Obtener clima por ciudad
        async function fetchWeatherByCity(city, apiKey) {
            try {
                console.log(`Obteniendo clima para ciudad: ${city}`);
                const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${apiKey}&units=metric&lang=es`);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('Datos del clima recibidos:', data);
                    updateWeatherDisplay(data);
                } else {
                    console.log('Error en respuesta de API:', response.status);
                    throw new Error(`Error en la API: ${response.status}`);
                }
            } catch (error) {
                console.error('Error obteniendo clima por ciudad:', error);
                // Usar API alternativa gratuita sin key
                await tryAlternativeWeatherAPI();
            }
        }

        // API alternativa sin necesidad de key
        async function tryAlternativeWeatherAPI(lat = null, lon = null) {
            try {
                let url = 'https://api.open-meteo.com/v1/forecast?current_weather=true&timezone=auto';
                
                if (lat && lon) {
                    url += `&latitude=${lat}&longitude=${lon}`;
                } else {
                    // Coordenadas de Madrid por defecto
                    url += '&latitude=40.4168&longitude=-3.7038';
                }
                
                console.log('Intentando API alternativa:', url);
                const response = await fetch(url);
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('Datos de API alternativa:', data);
                    updateAlternativeWeatherDisplay(data);
                } else {
                    throw new Error('API alternativa fall√≥');
                }
            } catch (error) {
                console.error('Error con API alternativa:', error);
                showFallbackWeather();
            }
        }

        // Mostrar datos de la API alternativa
        function updateAlternativeWeatherDisplay(weatherData) {
            const temp = Math.round(weatherData.current_weather.temperature);
            const weatherCode = weatherData.current_weather.weathercode;
            
            // Mapear c√≥digos de clima a descripciones
            const weatherDescriptions = {
                0: { desc: 'despejado', icon: '‚òÄÔ∏è' },
                1: { desc: 'mayormente despejado', icon: 'üå§Ô∏è' },
                2: { desc: 'parcialmente nublado', icon: '‚õÖ' },
                3: { desc: 'nublado', icon: '‚òÅÔ∏è' },
                45: { desc: 'neblinoso', icon: 'üå´Ô∏è' },
                48: { desc: 'niebla', icon: 'üå´Ô∏è' },
                51: { desc: 'llovizna ligera', icon: 'üå¶Ô∏è' },
                53: { desc: 'llovizna', icon: 'üå¶Ô∏è' },
                55: { desc: 'llovizna intensa', icon: 'üåßÔ∏è' },
                61: { desc: 'lluvia ligera', icon: 'üåßÔ∏è' },
                63: { desc: 'lluvia', icon: 'üåßÔ∏è' },
                65: { desc: 'lluvia intensa', icon: 'üåßÔ∏è' },
                80: { desc: 'chubascos', icon: 'üå¶Ô∏è' },
                95: { desc: 'tormenta', icon: '‚õàÔ∏è' }
            };
            
            const weather = weatherDescriptions[weatherCode] || { desc: 'clima variable', icon: 'üå°Ô∏è' };
            
            // Crear descripci√≥n KUCHAU
            let kuchauDescription;
            if (weather.desc.includes('despejado') || weather.desc.includes('claro')) {
                kuchauDescription = `${temp}¬∞C - Perfecto para KUCHAU al aire libre`;
            } else if (weather.desc.includes('nublado')) {
                kuchauDescription = `${temp}¬∞C - Nubes KUCHAU en el ambiente`;
            } else if (weather.desc.includes('lluvia') || weather.desc.includes('llovizna')) {
                kuchauDescription = `${temp}¬∞C - Lluvia KUCHAU, ¬°Fiesta interior!`;
            } else if (weather.desc.includes('tormenta')) {
                kuchauDescription = `${temp}¬∞C - Tormenta KUCHAU √©pica`;
            } else {
                kuchauDescription = `${temp}¬∞C - Clima KUCHAU perfecto`;
            }
            
            document.getElementById('weatherInfo').innerHTML = 
                `${weather.icon} ${kuchauDescription}`;
        }

        // Actualizar la visualizaci√≥n del clima con datos reales
        function updateWeatherDisplay(weatherData) {
            const temp = Math.round(weatherData.main.temp);
            const description = weatherData.weather[0].description;
            const city = weatherData.name;
            
            // Mapear condiciones meteorol√≥gicas a emojis
            const weatherIcons = {
                'clear sky': '‚òÄÔ∏è',
                'few clouds': 'üå§Ô∏è',
                'scattered clouds': '‚õÖ',
                'broken clouds': '‚òÅÔ∏è',
                'shower rain': 'üå¶Ô∏è',
                'rain': 'üåßÔ∏è',
                'thunderstorm': '‚õàÔ∏è',
                'snow': '‚ùÑÔ∏è',
                'mist': 'üå´Ô∏è',
                'despejado': '‚òÄÔ∏è',
                'poco nuboso': 'üå§Ô∏è',
                'nublado': '‚òÅÔ∏è',
                'lluvia': 'üåßÔ∏è',
                'tormenta': '‚õàÔ∏è',
                'nieve': '‚ùÑÔ∏è',
                'niebla': 'üå´Ô∏è'
            };
            
            const icon = weatherIcons[description.toLowerCase()] || 'üå°Ô∏è';
            
            // Crear descripci√≥n con toque KUCHAU
            const kuchauDescriptions = {
                clear: `${temp}¬∞C - Perfecto para KUCHAU al aire libre`,
                clouds: `${temp}¬∞C - Nubes KUCHAU en el ambiente`,
                rain: `${temp}¬∞C - Lluvia KUCHAU, ¬°Fiesta interior!`,
                thunderstorm: `${temp}¬∞C - Tormenta KUCHAU √©pica`,
                snow: `${temp}¬∞C - Nieve KUCHAU m√°gica`,
                default: `${temp}¬∞C - Clima KUCHAU perfecto`
            };
            
            let kuchauDescription = kuchauDescriptions.default;
            if (description.includes('clear') || description.includes('despejado')) {
                kuchauDescription = kuchauDescriptions.clear;
            } else if (description.includes('cloud') || description.includes('nub')) {
                kuchauDescription = kuchauDescriptions.clouds;
            } else if (description.includes('rain') || description.includes('lluvia')) {
                kuchauDescription = kuchauDescriptions.rain;
            } else if (description.includes('thunder') || description.includes('tormenta')) {
                kuchauDescription = kuchauDescriptions.thunderstorm;
            } else if (description.includes('snow') || description.includes('nieve')) {
                kuchauDescription = kuchauDescriptions.snow;
            }
            
            document.getElementById('weatherInfo').innerHTML = 
                `${icon} ${kuchauDescription} en ${city}`;
        }

        // Mostrar clima de fallback cuando no funciona la API
        function showFallbackWeather() {
            const kuchauWeatherConditions = [
                { condition: 'Energ√≠a KUCHAU al m√°ximo', icon: '‚ö°' },
                { condition: 'Vibes KUCHAU perfectas', icon: '‚ú®' },
                { condition: 'Ambiente KUCHAU incre√≠ble', icon: 'üî•' },
                { condition: 'Poder KUCHAU activado', icon: 'üí´' },
                { condition: 'Modo KUCHAU: ON', icon: 'üöÄ' },
                { condition: 'KUCHAU en su m√°ximo nivel', icon: '‚≠ê' }
            ];
            
            const randomWeather = kuchauWeatherConditions[Math.floor(Math.random() * kuchauWeatherConditions.length)];
            document.getElementById('weatherInfo').innerHTML = 
                `${randomWeather.icon} ${randomWeather.condition}`;
        }

        // Activar logo KUCHAU
        function activateKuchau() {
            playSound();
            const logo = document.getElementById('kuchauLogo');
            logo.classList.add('activated');
            
            // Efecto de ondas de energ√≠a
            createEnergyRipple(logo);
            
            setTimeout(() => {
                logo.classList.remove('activated');
            }, 1000);
            
            showToast('¬°KUCHAU ACTIVADO! ‚ö°', 'success');
        }

        // Activar actividad
        function activateActivity(activity) {
            const activities = {
                music: 'üéµ ¬°M√∫sica activada! Los beats est√°n listos',
                games: 'üéÆ ¬°Juegos preparados! Que comiencen las competencias',
                photos: 'üì∏ ¬°Photo booth listo! Prepara tu mejor pose',
                egg: 'ü•ö ¬°Misi√≥n Huevito activada! Cuidado con no romperlo mientras bailas',
                dance: 'üíÉ ¬°Baile del Huevo! Si se te cae,prepara tu baile m√°s rid√≠culo'
            };
            
            showToast(activities[activity], 'success');
            
            const card = document.querySelector(`[data-activity="${activity}"]`);
            card.classList.add('activated');
            setTimeout(() => card.classList.remove('activated'), 1000);
        }

        // Enviar RSVP
        function submitRSVP() {
            const name = document.getElementById('attendeeName').value.trim();
            const count = parseInt(document.getElementById('attendeeCount').value);
            const requests = document.getElementById('specialRequests').value.trim();
            
            if (!name) {
                showToast('Por favor ingresa tu nombre', 'error');
                return;
            }
            
            // Agregar a la lista
            attendees.push({ name, count });
            
            // Limpiar formulario
            document.getElementById('attendeeName').value = '';
            document.getElementById('attendeeCount').value = '1';
            document.getElementById('specialRequests').value = '';
            
            showToast(`¬°Gracias ${name}! Tu asistencia ha sido confirmada üéâ`, 'success');
            
            // Efecto de celebraci√≥n
            triggerCelebrationEffect();
        }

        // Control de m√∫sica
        function initializeMusicControl() {
            const backgroundMusic = document.getElementById('backgroundMusic');
            backgroundMusic.volume = 0.3; // Volumen al 30%
        }

        function toggleMusic() {
            if (youtubePlayer && musicInitialized) {
                // Control de YouTube
                if (isPlayingMusic) {
                    youtubePlayer.pauseVideo();
                    isPlayingMusic = false;
                    showToast('M√∫sica pausada', 'success');
                } else {
                    youtubePlayer.playVideo();
                    isPlayingMusic = true;
                    showToast('M√∫sica activada üéµ', 'success');
                }
            } else {
                // Fallback a audio HTML5
                const backgroundMusic = document.getElementById('backgroundMusic');
                
                if (isPlayingMusic) {
                    backgroundMusic.pause();
                    isPlayingMusic = false;
                    showToast('M√∫sica pausada', 'success');
                } else {
                    backgroundMusic.play().then(() => {
                        isPlayingMusic = true;
                        showToast('M√∫sica activada üéµ', 'success');
                    }).catch(() => {
                        showToast('No se pudo reproducir la m√∫sica. Intenta hacer clic primero en la p√°gina.', 'error');
                    });
                }
            }
            updateMusicStatus();
        }
        // Hacer elementos editables
        function makeEditable(element) {
            const valueElement = element.querySelector('.detail-value');
            const currentValue = valueElement.textContent;
            
            valueElement.innerHTML = `<input type="text" value="${currentValue}" onblur="saveEdit(this)" onkeypress="handleEnter(event, this)">`;
            valueElement.querySelector('input').focus();
        }

        function saveEdit(input) {
            const newValue = input.value.trim();
            if (newValue) {
                input.parentElement.textContent = newValue;
                showToast('Informaci√≥n actualizada ‚úÖ', 'success');
            }
        }

        function handleEnter(event, input) {
            if (event.key === 'Enter') {
                input.blur();
            }
        }

        // Efectos visuales
        function createEnergyRipple(element) {
            const ripple = document.createElement('div');
            ripple.className = 'energy-ripple';
            element.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 1000);
        }

        function createEnergyParticles(element) {
            for (let i = 0; i < 5; i++) {
                const particle = document.createElement('div');
                particle.className = 'energy-particle';
                particle.textContent = '‚ö°';
                
                const rect = element.getBoundingClientRect();
                particle.style.left = rect.left + rect.width/2 + 'px';
                particle.style.top = rect.top + rect.height/2 + 'px';
                
                document.body.appendChild(particle);
                
                setTimeout(() => {
                    particle.remove();
                }, 1000);
            }
        }

        function triggerKuchauExplosion() {
            document.body.classList.add('kuchau-explosion');
            showToast('¬°EXPLOSI√ìN KUCHAU! üí•‚ö°üéâ', 'celebration');
            
            setTimeout(() => {
                document.body.classList.remove('kuchau-explosion');
            }, 3000);
        }

        function triggerCelebrationEffect() {
            const celebration = document.createElement('div');
            celebration.className = 'celebration-effect';
            celebration.innerHTML = 'üéâüéä‚ú®';
            document.body.appendChild(celebration);
            
            setTimeout(() => {
                celebration.remove();
            }, 2000);
        }

        // Efectos de fondo
        function createBackgroundEffects() {
            const particlesContainer = document.querySelector('.floating-particles');
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'bg-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 5 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 2) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Inicializar efectos KUCHAU
        function initializeKuchauEffects() {
            // Crear palabras KUCHAU flotantes
            setInterval(() => {
                if (Math.random() < 0.3) {
                    createFloatingKuchau();
                }
            }, 3000);
        }

        function createFloatingKuchau() {
            const kuchau = document.createElement('div');
            kuchau.className = 'floating-kuchau-word';
            kuchau.textContent = 'KUCHAU';
            kuchau.style.left = Math.random() * 100 + '%';
            document.body.appendChild(kuchau);
            
            setTimeout(() => {
                kuchau.remove();
            }, 4000);
        }

        // Sistema de notificaciones
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toastNotification');
            toast.textContent = message;
            toast.className = `toast-notification show ${type}`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Reproducir sonido
        function playSound() {
            const audio = document.getElementById('clickSound');
            audio.currentTime = 0;
            audio.play().catch(() => {
                // Ignorar errores de audio en algunos navegadores
            });
        }

        // Actualizaciones en vivo
        function startLiveUpdates() {
            // Solo el contador regresivo se actualiza ahora
        }

        // Easter eggs
        let konamiCode = [];
        const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA'];

        document.addEventListener('keydown', function(event) {
            konamiCode.push(event.code);
            
            if (konamiCode.length > konamiSequence.length) {
                konamiCode.shift();
            }
            
            if (konamiCode.join(',') === konamiSequence.join(',')) {
                triggerSecretKuchau();
                konamiCode = [];
            }
        });

        function triggerSecretKuchau() {
            document.body.classList.add('secret-mode');
            showToast('¬°MODO SECRETO KUCHAU ACTIVADO! üî•üíé‚ö°', 'celebration');
            
            setTimeout(() => {
                document.body.classList.remove('secret-mode');
            }, 10000);
        }

        // Hacer la funci√≥n accesible globalmente para la API de YouTube
        window.onYouTubeIframeAPIReady = onYouTubeIframeAPIReady;
        function activateFloatingKuchau() {
    energyLevel += 10;
    clickCount++;
    
    const energyCounter = document.getElementById('energyCounter');
    if (energyCounter) {
        energyCounter.textContent = energyLevel;
    }
    
    const floatingBtn = document.getElementById('kuchauFloating');
    if (floatingBtn) {
        floatingBtn.classList.add('energy-boost');
        
        setTimeout(() => {
            floatingBtn.classList.remove('energy-boost');
        }, 300);
    }
    
    playSound();
    showToast(`¬°Energ√≠a KUCHAU: ${energyLevel}! ‚ö°`, 'success');
    
    // Efectos especiales cada 50 clicks
    if (clickCount % 50 === 0) {
        triggerKuchauExplosion();
    }
}

// Actualizar reloj en tiempo real
function updateLiveTime() {
    const liveTime = document.getElementById('liveTime');
    if (liveTime) {
        const now = new Date();
        const timeString = now.toLocaleTimeString('es-ES', {
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        });
        liveTime.textContent = `üïê ${timeString}`;
    }
}
    </script>
</body>
</html>
